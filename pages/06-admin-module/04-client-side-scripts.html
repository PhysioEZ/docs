<div class="breadcrumbs">
    <a href="pages/introduction.html" class="nav-link">Docs</a>
    <span>/</span>
    <a href="pages/06-admin-module/01-overview.html" class="nav-link">Admin Module</a>
    <span>/</span>
    <span>Client-Side Scripts</span>
</div>

<section id="js-intro">
    <h1>Admin Module: Client-Side Scripts (JavaScript)</h1>
    <p>The <code>/admin/js/</code> directory contains the client-side logic for the Admin Module. These scripts
        enable user interaction, validation, and asynchronous communication with backend API endpoints using the
        Fetch API.</p>
    <p>This documentation categorizes scripts into Core UI logic, Modern Employee management, and Legacy components.
    </p>
</section>

<section id="js-definitions">
    <h2>Primary Client-Side Scripts In-Depth</h2>

    <h3>1. Core UI & Utility Scripts</h3>
    <p>These scripts manage foundational UI behavior and application flow.</p>

    <h4 id="sidebar-js">sidebar.js (UI Persistence)</h4>
    <div class="js-script">
        <p>This script maintains the state and behavior of the main navigation sidebar.</p>
        <ul>
            <li><strong>Purpose:</strong> Controls expanding and collapsing of the fixed left sidebar
                (<code>#admin-sidebar</code>).</li>
            <li><strong>Associated Views:</strong> All Admin Module views.</li>
            <li><strong>Core Logic:</strong>
                <ol>
                    <li>Reads <code>sidebarState</code> from Local Storage to restore user preference.</li>
                    <li>Toggles UI classes (<code>is-expanded</code>, <code>sidebar-is-expanded</code>) to adjust
                        layout.</li>
                    <li>Updates the toggle button icon (<code>#sidebar-toggle</code>) dynamically.</li>
                    <li>Allows keyboard shortcut toggling via <strong>Ctrl+B</strong> or <strong>Shift+B</strong>.
                    </li>
                </ol>
            </li>
        </ul>
    </div>

    <h4 id="welcome-js">welcome.js (Loading Animation)</h4>
    <div class="js-script">
        <p>Controls the animated loading screen displayed after login.</p>
        <ul>
            <li><strong>Purpose:</strong> Shows a progress bar with status messages during initialization.</li>
            <li><strong>Associated View:</strong> Login landing page.</li>
            <li><strong>Core Logic:</strong>
                <ol>
                    <li>Simulates load progress using <code>setInterval</code> over ~3 seconds.</li>
                    <li>Updates status text (<code>#progressText</code>) based on progress thresholds.</li>
                    <li>Redirects to <code>views/dashboard.php</code> after 3000 ms.</li>
                </ol>
            </li>
        </ul>
    </div>

    <hr />

    <h3>2. Employee Management Scripts (CRUD)</h3>
    <p>These scripts handle employee data creation and updates using shared modal and toast functions.</p>

    <h4 id="manage-users-js">manage_users.js (Modern & Consolidated)</h4>
    <div class="js-script">
        <p>The primary controller for the modern employee management interface.</p>
        <ul>
            <li><strong>Associated View:</strong> <code>manage_users.php</code></li>
            <li><strong>API Endpoint:</strong> <code>../api/manage_user_actions.php</code></li>
            <li><strong>Key Features:</strong> Uses event delegation for handling edit button clicks.</li>
            <li><strong>Submission Logic:</strong>
                <ol>
                    <li><strong>Add Mode:</strong> Resets form, sets action to <code>create_employee</code>, makes
                        password fields required.</li>
                    <li><strong>Edit Mode:</strong> Loads employee JSON from <code>data-employee</code>, sets action
                        to <code>update_employee</code>, makes password optional.</li>
                    <li><strong>Validation:</strong> Ensures password match and minimum length if provided.</li>
                    <li><strong>Processing:</strong> Sends JSON via Fetch POST, shows success toast, reloads page
                        after 1.5s.</li>
                </ol>
            </li>
        </ul>
    </div>

    <h4 id="manage-employees-js">manage_employees.js (Legacy Edit)</h4>
    <div class="js-script">
        <p>Legacy script for basic employee detail updates.</p>
        <ul>
            <li><strong>Associated View:</strong> <code>manage_employees.php</code></li>
            <li><strong>API Endpoint:</strong> <code>../api/manage_user_actions.php</code></li>
            <li><strong>Core Logic:</strong>
                <ol>
                    <li>Loads employee data into the edit modal.</li>
                    <li>Forces form action to <code>update_employee</code>.</li>
                    <li>Shows toast on success and reloads page.</li>
                </ol>
            </li>
        </ul>
    </div>

    <hr />

    <h3>3. Messaging Scripts</h3>

    <h4 id="chat-js">chat.js (Real-Time Communication)</h4>
    <div class="js-script">
        <p>Handles the real-time admin chat system.</p>
        <ul>
            <li><strong>Associated View:</strong> <code>dashboard.php</code></li>
            <li><strong>Primary APIs:</strong>
                <ul>
                    <li>User List → <code>../api/fetch_all_users.php</code></li>
                    <li>Messaging → <code>../../reception/api/chat_api.php</code></li>
                </ul>
            </li>
            <li><strong>Core Functions:</strong>
                <ol>
                    <li>Retrieves employees and renders the chat user list with search.</li>
                    <li>Sets the active chat partner and updates header info.</li>
                    <li>Loads message history and displays file types appropriately.</li>
                    <li>Creates a hidden file input for attachments during send.</li>
                    <li>Supports image preview, Enter-to-send, and auto-scroll.</li>
                </ol>
            </li>
        </ul>
    </div>
</section>